---
layout: post
title: "一文理解所有常见安全算法"
description: "介绍所有常见的安全算法，包括对称加密、非对称加密、数字签名等"
date: 2025-03-09T14:54:24+08:00
image: "/posts/blockchain/images/chapter_1-cover.jpg"
tags: ["Blockchain"]
---
## 信息安全问题

通过网络交换数据时，数据要经过各种各样的网络环境和设备，在传输过程中有可能会经过某些恶意用户的设备，从而导致内容被盗取。在网络中传输数据时，通常要考虑四个主要问题。

* 窃听：消息在传输过程中被窃听。
* 冒名：假冒消息的发送者或接收者。
* 篡改：消息在传输过程中被篡改。
* 否认：消息发送者事后否认自己发送消息的行为。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-main-problems.jpg" width="100%">
<p>Main Problems</p>
</div>

为了解决上述问题，我们需要使用一些安全算法，让我们来看看这些算法是如何解决这些问题的吧。

## 安全算法

### 加密算法

为了应对窃听问题，我们需要让消息的发送方使用加密密钥对消息进行加密，再让消息的接收方在接收到密文后，使用解密密钥进行解密，获得真实的消息内容。由于实际传输的是密文，传输过程中就算被窃听，窃听者在没有解密密钥的情况下，也无法获取消息的实际内容。这种对消息加解密的算法有两种，一种是加解密使用相同密钥的“对称加密”，以及加解密使用不同密钥的“非对称加密”。

#### 对称加密

对称加密，发送方使用密钥加密消息，将密文传输给接收方，接收方使用同样的密钥对密文进行解密，得到消息。这样即使密文被第三方窃听，没有密钥的情况下，也无法取得消息原文。常见的对称加密算法有 AES、DES 等。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-symmetric-encryption.jpg" width="80%">
<p>Symmetric Encryption</p>
</div>

但假设发送方和接收方无法直接沟通，接收方一开始不知道密文，需要发送方将密文发送给接收方，那么密钥也存在被窃听的风险，此时，消息的安全性就无法得到保障了。因此需要找到能将密钥安全送出的方法，这就是“密钥分配问题”。要解决密钥分配问题，可以使用安全的“密钥交换协议”（如迪菲-赫尔曼密钥交换）或“非对称加密”这两种方法。

#### 非对称加密

非对称加密可以解决对称加密存在的“密钥分配问题”。消息接收方会准备一组公私钥，公钥公开发布，私钥自己保管，当消息发送方准备发送消息时，通过接收方公开的公钥对消息进行加密，将密文传输给接收方，接收方使用私钥对密文进行解密，得到消息。常见的非对称加密算法有 RAS 、椭圆曲线加密等。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-asymmetric-encryption.jpg" width="80%">
<p>Asymmetric Encryption</p>
</div>

但假设第三方将消息接收方公开的公钥偷偷替换成自己的公钥，消息发送方将使用第三方的公钥对消息进行加密，此时第三方窃听到密文，使用自己的私钥解密获得消息，再将消息用接收方的公钥加密获得新密文，发送给接收方，接收方不会意识到消息已经被窃听。这种通过替换公钥来窃听消息的攻击方式叫做“中间人攻击”。要解决公钥的可靠性问题，需要使用“数字证书”。

另外，非对称加密算法加解密操作都比较耗时，所以这种方法不适用于持续发送零碎消息的情况。要避免“密钥分配问题”，又要保证效率，就需要使用“混合加密”算法。

#### 混合加密

对称加密存在无法安全传输密钥的密钥分配问题，非对称加密又存在加密解密速度较慢的问题。结合这两种方法以实现互补的一种加密方法就是混合加密，其核心思想是通过对称加密的共享密钥来加解密消息，并使用非对称加密安全传输共享密钥。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-hybrid-encryption.jpg" width="60%">
<p>Hybrid Encryption</p>
</div>

混合加密在安全性和处理速度上都有优势，为网络提供通信安全的SSL/TLS协议也应用了混合加密方法。当然，混合加密也是无法规避因无法保证公钥来源，而导致的冒名问题。

### 验证算法

为了应对冒名、篡改和否认问题，我们需要对消息发送方的身份和消息内容进行验证。

#### 消息认证码

消息认证码是一种可以验证消息在传输过程中是否被篡改过的算法。通信双方除了会交换消息密文外，还会交换消息认证码，消息发送方与接收方共享消息认证码生成密钥，发送方使用该密钥对消息密文进行计算得到消息认证码，将消息密文和消息认证码都发送给接收方，接收方拿到消息后，同样使用消息认证码生成密钥生成认证码，比较接收到的认证码和自己计算得到的认证码是否相同，相同则说明消息密文没有被篡改。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-message-verification-code.jpg" width="80%">
<p>Message Verification Code</p>
</div>

当然，如果消息接收方和发送方无法直接沟通，分享消息认证码生成密钥会遇到“密钥分配问题”。同时由于通信双方都持有认证码生成密钥，通信双方如果有一方在发送消息后否认，污蔑是对方发送的消息，消息认证码也无法辨认。“数字签名”可以很好的解决这两个问题。

#### 数字签名

数字签名不仅可以实现消息认证码的检测篡改功能，还可以预防事后否认的问题，因为生数字签名只能由发送方生成。

使用数字签名，首先要求消息发送方准备一组公私钥，这与非对称加密相反，非对称加密是由消息接收方准备公私钥的。发送方发送消息时，会对消息的哈希值使用私钥加密，生成数字签名，并把签名也发送给消息接收方，接收方收到消息和签名后，对消息执行哈希运算得到哈希值，并通过发送方的公钥对数字签名进行解密得到收到消息哈希值，对比两个哈希值是否相等，相等则说明消息来自于发送方，并且消息未被篡改。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-digital-signature.jpg" width="50%">
<p>Digital Signature</p>
</div>

但就像非对称加密、混合加密一样，数字签名也无法保证公钥的来源，所以无法解决冒名问题。为了解决这个问题，就需要使用“数字证书”。

### 数字证书

数字证书用于证明公钥的来源信息，是。数字证书由可信的第三方机构签发，这样的机构称为认证中心（Certification Authority, CA）。当某人希望发布公钥时，为了让自己的公钥是可信的，他需要向认证中心申请该公钥的数字证书。首先他需要将自己的信息和邮箱，以及要发布的公钥一起提交给认证中心，认证中心在核对信息无误、验证邮箱之后，为该申请人签发该公钥的数字证书，其实就是对申请人的资料和公钥用认证中心的私钥进行数字签名。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-digital-certificate.jpg" width="50%">
<p>Digital Certificate</p>
</div>

当他人拿到该数字证书后，通过认证中心的公钥来验证数字证书的可信性。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-certification-authority.jpg" width="50%">
<p>Certification Authority</p>
</div>

你也许会想说认证中心的公钥也有可能被替换，如何来保证认证中心的公钥可信性呢？其实认证中心的公钥也是数字证书形式的，一般由更高规格的认证中心发行，形成树形结构，其中最顶端的认证中心被称为“根认证中心”（Root CA），其自身正当性由自己证明，如果根认证中心不被信任，整个组织也就无法运作，所以根认证中心多为大型企业或政府认证组织。

<div class="content-image">
<img src="/posts/blockchain/images/chapter_1-ca-tree.jpg" width="60%">
<p>CA Tree</p>
</div>

数字证书就是像这样通过认证中心来担保公开密钥的制作者，这一系列技术规范被统称为“公钥基础设施”​（Public Key Infrastructure, PKI）​。

## 总结

* 通过网络进行数据传输时，需要考虑窃听、冒名、篡改、否认这四个主要安全问题。

* 通过加密算法可以解决窃听问题，这类算法有对称加密、非对称加密，以及结合两者的混合加密，混合加密既保证了共享密钥的安全性，又保证了加密的效率。

* 通过验证算法可以解决篡改、否认的问题，其中消息认证码可以解决篡改问题，而数字签名可以解决篡改和否认问题。

* 对于使用了非对称密钥的非对称加密、混合加密和数字签名算法来说，都需要面对公钥被替换而导致的冒名问题，而数字证书可以保证被认证的公钥的可信性。